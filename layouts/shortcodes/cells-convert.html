
<style>
*,*::before,*::after {
    box-sizing: border-box
}

h1, h2, h3, h4, h5, p {
	margin-bottom:0.8em ;
	margin-top:0.8em ;
}

li {
	margin-bottom:0.8em ;
}

a {
	//text-decoration: underline !important;
}

a:hover {
	//text-decoration: underline !important;
	//color:blue
}

.panelContainer {
{{ if .Get "IsLandingPage" }}
    width: 150%;
{{ else }}
    width: 150%;
{{ end }}    
}
.csColor {
    background: #5d8000
}
.parametersblock h3,.parametersblock .h3 {
    background: silver;
    font-size: 13px;
    font-weight: 700;
    padding: 10px;
    border-radius: 10px 10px 0 0;
    margin: 0
}
@media screen and (max-width: 768px) {
    .parametersblock h3,.parametersblock .h3 {
        text-align:center
    }
}
.parametersBox {
    color: #f8f8f2 !important;
    background-color: #2b2b2b !important
}
.parametersBox #fileInput {
    font-size: 0;
    width: 1px;
    height: 1px
}
.parametersBox .description {
    text-align: left;
    margin: auto;
    padding: 10px 10px 10px 20px;
    box-sizing: border-box
}

.parametersBox .description span.position {
    display: inline-block;
    margin-left: 25px
}

.parametersBox .action {
    text-align: right;
    margin: auto;
    padding: 10px 20px 10px 10px
}

.parametersBox .action.output-format {
    padding-left: 5px
}



.row {
    --bs-gutter-x: 1.5rem;
    --bs-gutter-y: 0;
    display: flex;
    flex-wrap: wrap;
    margin-top: calc(var(--bs-gutter-y)*-1);
    margin-right: calc(var(--bs-gutter-x)*-0.5);
    margin-left: calc(var(--bs-gutter-x)*-0.5)
}
.col-4 {
    flex: 0 0 auto;
    width: 25%;
    padding-left:10px !important;
}

.pt-3 {
    padding-top: 1rem !important;
    margin-left:0px;
    margin-right:0px;
}
.pb-3 {
    padding-bottom: 1rem !important;
    margin-left:0px;
    margin-right:0px;
}

.fileInput {
    opacity: 0;
    position: absolute;
    z-index: -1
}

.parametersBox #fileInput {
    font-size: 0;
    width: 1px;
    height: 1px
}


.actionButton {
    height: 45px;
    width: 150px;
    background: #8fd14f;
    color: #fff;
    padding: 10px 15px;
    font-size: 16px;
    font-weight: 400;
    outline: 0 !important;
    border: 1px solid #5c5c5c !important;
    display: inline-block;
    margin-bottom: 0;
    text-align: center;
    white-space: nowrap;
    vertical-align: middle;
    touch-action: manipulation;
    cursor: pointer;
    line-height: 1.42857143;
    user-select: none;
    text-decoration: none;
    transition: opacity .2s ease-in
}

.actionButton:hover {
    opacity: .8;
    text-decoration: none;
    color: #fff
}

.backgroundBlue {
    background: #2d9bf0
}
label.fileInputLabel {
    word-break: break-word;
    height: initial;
    white-space: initial
}
.disabled {
    pointer-events: none;
    cursor: default;
    opacity: .6
}
select:disabled {
    opacity: 1
}

button:not(:disabled),[type=button]:not(:disabled),[type=reset]:not(:disabled),[type=submit]:not(:disabled) {
    cursor: pointer
}
a#runCodeButtonMobile.actionButton.disabled,a#runCodeButton.actionButton.disabled {
    opacity: .9;
    background-color: #5e7e3e
}

.codeBox {
    color: #f8f8f2 !important;
    background-color: #2b2b2b !important;
    margin-bottom: 0 !important;
    //font-size: 16px;
    padding-left: 15px;
    line-height: initial
}
pre,code,kbd,samp {
    font-family: var(--bs-font-monospace);
    //font-size: 1em;
    direction: ltr /* rtl:ignore */;
    unicode-bidi: bidi-override
}

pre {
    display: block;
    margin-top: 0;
    margin-bottom: 1rem;
    overflow: auto;
    font-size: 0.875em
}

pre code {
    font-size: inherit;
    color: inherit;
    word-break: normal
}

@media screen and (max-width: 768px) {
    .codeBox {
        padding-left:0
    }
}
.rowLine {
    border-top: 1px solid silver
}

.only-in-mobile-block,.only-in-mobile-flex,.only-in-small-desktop-block,.only-in-small-desktop-flex {
    display: none
}

.clipboard {
    float: right;
    touch-action: manipulation;
    cursor: pointer
}
.leftboard {
    float: left;
    touch-action: manipulation;
    cursor: pointer
}

.clipboard:hover {
    color: #468c02;
    fill: #468c02
}

.clipboard .bi-clipboard {
    width: 20px;
    height: 20px
}

.clipboard a {
    position: relative;
    user-select: none;
    text-decoration: none;
    color: #0f0f0f;
    touch-action: manipulation;
    cursor: pointer;
    font-weight: 700
}

.clipboard a:hover {
    color: #468c02
}

@media screen and (max-width: 768px) {
    .clipboard {
        float:none
    }
}

@media screen and (max-width: 992px) {
    .only-in-small-desktop-block {
        display:block
    }

    .hide-in-small-desktop-block {
        display: none
    }

    .only-in-small-desktop-flex {
        display: flex
    }

    .hide-in-small-desktop-flex {
        display: none
    }
}

@media screen and (max-width: 768px) {
    .only-in-mobile-block {
        display:block
    }

    .hide-in-mobile-block {
        display: none
    }

    .only-in-mobile-flex {
        display: flex
    }

    .hide-in-mobile-flex {
        display: none
    }

    .langbox {
        min-width: 50%
    }
}

@media screen and (max-width: 768px) {
    .codeblock h3,.codeblock .h3 {
        text-align:center;
        line-height: 0
    }
}

@media screen and (max-width: 768px) {
    .only-in-mobile-block {
        display:block
    }

    .hide-in-mobile-block {
        display: none
    }

    .only-in-mobile-flex {
        display: flex
    }

    .hide-in-mobile-flex {
        display: none
    }

    .langbox {
        min-width: 50%
    }
}

@media screen and (max-width: 992px) {
    .panelContainer {
        width:95%;
        margin-left: auto;
        margin-right: auto
    }
}

@media screen and (max-width: 768px) {
    .panelContainer {
        width:100%;
        margin-left: auto;
        margin-right: auto
    }
}

</style>
{{ $inputformat := .Get "InputFormat" | default "primary" }}   
<script>
    function updateFilename(){
        var file = document.getElementById("fileInput");
        if(file.files.length>0)
        {
            document.getElementById("showInputFileName").innerText =file.files[0].name;        
            document.getElementById("inputFilename").innerText ="\""+file.files[0].name +"\"";       
            document.getElementById("outputFilename").innerText ="\""+file.files[0].name.split('.').slice(0, -1).join('.') + "." + document.getElementById("selectOutputFormat").value +"\"";                  
        }
    }
    function copyCode() {
        var e = document.getElementById("snippet");
        // navigator.clipboard.writeText(e.innerText);
        if (navigator.clipboard && window.isSecureContext) {
                return navigator.clipboard.writeText(e.innerText);
        } else {
            let textArea = document.createElement("textarea");
            textArea.value = e.innerText;
            textArea.style.position = "absolute";
            textArea.style.opacity = 0;
            textArea.style.left = "-999999px";
            textArea.style.top = "-999999px";
            document.body.appendChild(textArea);
            textArea.focus();
            textArea.select();
            // return new Promise((res, rej) => {
            //     document.execCommand('copy') ? res() : rej();
            //     textArea.remove();
            //     e.focus();
            //     e.select();
            // });
            try{
                let result =  document.execCommand('copy');
                textArea.remove();
            }
            catch
            {
                document.removeChild("textarea");
            }
            var appui = document.getElementById("appui");            
            appui.scrollIntoView();
        }
            
    }
    function changeOutputFileInSnippet(format){
        var file = document.getElementById("fileInput");
        if(file.files.length>0){
            document.getElementById("outputFilename").innerText ="\""+file.files[0].name.split('.').slice(0, -1).join('.') + "." + format +"\"";  
        }else{
            document.getElementById("outputFilename").innerText ="\"Output."+format +"\"";
        }
    }
    function runCode() {
        var file = document.getElementById("fileInput");
        if(file.files.length>0)
        {
            var formData = new FormData();
            formData.append( file.files[0].name,  file.files[0]);

            var xhr = new XMLHttpRequest();
            var convertFormat = document.getElementById("selectOutputFormat").value;
            var url = 'https://api.products.aspose.app/cells/conversion/api/ConversionApi/Convert?outputType=' +convertFormat;
            xhr.open("POST", url, true);

            // function execute after request is successful 
            xhr.onreadystatechange = function () {
                if (this.readyState == 4 && this.status == 200) {
                    var fileInfo = JSON.parse(this.responseText);
                    href_url = 'https://api.products.aspose.app/cells/conversion/api/Download/' + fileInfo['FolderName'] + '?file=' +fileInfo['FileName'];
                    document.getElementById("runstatus").style.display ="none";  
                    window.location =href_url;
                    // return;
                }                
            }
            document.getElementById("runstatus").style.display ="";  
            // Sending our request 
            xhr.send(formData);
    }
    }
</script>
{{ if .Get "IsLandingPage" }}
<div class="container-fluid productfamilypage">
    <div class="features-section singleproduct">
        <div class=container>
            <div class=row>
                <div class="remove-rp remove-lp col-lg-12">
{{ end }}                    
<div class="panelContainer">
    <div >
        <div id="appui" class="parametersblock">
        <div class="h3">
            {{ .Get "title" }}
        </div>
        <div class="parametersBox">
            <div class="row pt-3">
                <div class="col-4 description">
                    <span class="position">
                    Input file
                    </span>
                </div>
                <div class="col-4 action">
                    <form id="fileInputContainer">
                    <input type="file" class="fileInput" id="fileInput" accept=".{{ $inputformat }}" onchange="updateFilename()" >
                    <label class="actionButton backgroundBlue fileInputLabel" for="fileInput">Upload a file</label>
                    </form>
                </div>
                <div class="col-4 description hide-in-mobile-block">
                    <span id="showInputFileName" class="fileName" ></span>
                </div>
                <div class="col-4 action hide-in-mobile-block hide-in-small-desktop-block">
                    <a class="actionButton" id="runCodeButton" type="button" onclick="runCode()">Convert</a>
                </div>
            </div>
            <div class="row pb-3">
                <div class="col-4 description">
                    <span class="position">Output format</span>
                </div>
                <div class="col-4 action output-format">
                <select class="actionButton backgroundBlue" id="selectOutputFormat" onchange="changeOutputFileInSnippet(this.options[this.selectedIndex].value)">                        
                    <option value="docx">DOCX</option>
                    <option value="pdf" selected="selected">PDF</option>
                    <option value="md">MD</option>
                    <option value="html">HTML</option>
                    <option value="txt">TXT</option>
                    <option value="mhtml">MHTML</option>
                    <option value="odt">ODT</option>
                    <option value="ott">OTT</option>
                    <option value="xps">XPS</option>
                    <option value="png">PNG</option>
                    <option value="bmp">BMP</option>
                    <option value="emf">EMF</option>
                    <option value="gif">GIF</option>
                    <option value="svg">SVG</option>
                    <option value="tiff">TIFF</option>
                    <option value="jpg">JPG</option>                    
                </select>
                </div>
                <div class="col-4 description hide-in-mobile-block"> </div>
                <div class="col-4 hide-in-mobile-block hide-in-small-desktop-block"></div>
            </div>
            <div style="border-top:1px solid silver" ></div>
        </div>
        </div>
    </div>
    <div>
      <div id="code" class="codeblock">
        <div >
            
			<div class="row run-code-button only-in-mobile-flex only-in-small-desktop-flex">
                <div class="col action">
                    <a class="actionButton disabled" id="runCodeButtonMobile" type="button" onclick="runCode()">Convert</a>
                </div>
            </div>
        </div>
        <div class="h3" >
            <div id="runstatus" class="leftboard" style="display: none; background-color:lightgrey">
                <svg  height="20"><g> <text  font-size="10" y="10" x="10" > ||| <animate attributeName="x" from="20" to="190" begin="0s" dur="3s" repeatCount="indefinite" /></text></g></svg>
            </div>            
            
        </div>
        </div> 
    </div>
</div>

<script>
    function loadOutFormatsSelect(){
        var formats = {{ .Get "formats" }}.split(';');
        var formatlength = formats.length;
        var selectOutFormats =  document.getElementById("selectOutputFormat")  ;
        if(formatlength > 0){
            selectOutFormats.options.length =0;
            for(var i=0;i<formatlength;i++){    
                var option = document.createElement("option");
                option.value = formats[i];
                option.text = formats[i].toUpperCase();
                selectOutFormats.add(option);
            }            
        }    
        var outformat = {{ .Get "outformat" }};
        selectOutFormats.selectedIndex = formats.indexOf(outformat);
        changeOutputFileInSnippet(outformat);
        {{ if .Get "InputFormat" }}
        document.getElementById("inputFilename").innerText = "\"input." + {{ .Get "InputFormat" }}+ "\"" ;
        {{ end }}
    }
    loadOutFormatsSelect();
</script>
{{ if .Get "IsLandingPage"}}
</div>
</div>
</div>
</div>
</div>
{{end}}  